<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PlayMatatu - Game</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Game Styles -->
    <link rel="stylesheet" href="/css/game.css">
</head>
<body class="game-page" style="background: linear-gradient(135deg, #373536 0%, #676566 100%); margin: 0; padding: 0; min-height: 100vh;">
    
    <!-- WAITING ROOM SCREEN -->
    <div id="waiting-room" style="display: flex; align-items: center; justify-content: center; min-height: 100vh; flex-direction: column; color: white;">
        <div class="spinner-border text-light mb-4" role="status" style="width: 4rem; height: 4rem;">
            <span class="visually-hidden">Loading...</span>
        </div>
        <h2 id="waiting-message" style="font-size: 1.5rem; margin-bottom: 1rem;">Waiting for opponent...</h2>
        <p style="color: rgba(255,255,255,0.7); font-size: 1rem;">Game will start when both players are connected</p>
    </div>

    <!-- GAME SCREEN -->
    <div id="game-screen" style="display: none;" class="game-screen">
        
        <!-- Opponent Hand (Top) -->
        <div class="opponent-hand-container">
            <div id="opponent-hand" class="opponent-hand">
                <!-- Opponent cards rendered by game.js -->
            </div>
        </div>

        <!-- Game Center Area (Deck, Discard, Turn Indicator) -->
        <div class="game-center">
            
            <!-- Deck Stack (with Chop Card underneath) -->
            <div class="deck-container" id="deck-btn">
                <!-- Chop Card (Target Suit - shows actual target card) -->
                <div id="chop-card" class="chop-card" style="display: none;">
                    <img id="chop-card-img" src="" alt="Chop Card" class="playing-card">
                </div>
                
                <!-- Draw Deck -->
                <div class="deck-stack" id="deck-stack">
                    <div class="game-card" style="position: absolute; top: 0; left: 0;">
                        <div class="card-face card-back"><img src="/images/logo.png" alt="Matatu"></div>
                    </div>
                    <div class="game-card" style="position: absolute; top: 0; left: 0; transform: translate(-4px, -4px) rotate(-2deg);">
                        <div class="card-face card-back"><img src="/images/logo.png" alt="Matatu"></div>
                    </div>
                    <div class="game-card" style="position: absolute; top: 0; left: 0; transform: translate(-8px, -8px) rotate(-4deg);">
                        <div class="card-face card-back"><img src="/images/logo.png" alt="Matatu"></div>
                    </div>
                </div>
            </div>

            <!-- Turn Indicator -->
            <button id="turn-indicator" class="btn btn-outline-light rounded-circle d-flex align-items-center justify-content-center fw-bold text-uppercase" 
                    type="button" 
                    style="width: 120px; height: 120px; font-size: 0.75rem; opacity: 0.6; border-width: 3px;">
                WAIT
            </button>

            <!-- Discard Pile (Top Card) -->
            <div class="discard-pile" id="discard-pile">
                <!-- Top card shown here -->
            </div>
        </div>

        <!-- Player Hand (Bottom) -->
        <div class="player-hand-container">
            <div id="player-hand" class="player-hand">
                <!-- Player cards rendered by game.js -->
            </div>
        </div>
    </div>

    <!-- Game Messages/Toast -->
    <div id="game-message" class="alert alert-info d-none" style="position: fixed; top: 20px; left: 50%; transform: translateX(-50%); z-index: 1000; min-width: 300px; text-align: center;">
        <span id="message-text"></span>
    </div>

    <!-- Disconnect Warning -->
    <div id="disconnect-warning" class="alert alert-warning d-none" style="position: fixed; top: 80px; left: 50%; transform: translateX(-50%); z-index: 1000; min-width: 300px; text-align: center;">
        Opponent disconnected. They have <span id="countdown">120</span> seconds to reconnect.
    </div>

    <!-- Game Over Modal -->
    <div class="modal fade" id="game-over-modal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow-lg" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                <div class="modal-body text-center p-5">
                    <!-- Emoji -->
                    <div id="result-emoji" class="display-1 mb-4" style="font-size: 5rem;"></div>
                    
                    <!-- Title -->
                    <h2 id="result-title" class="text-white fw-bold mb-3"></h2>
                    
                    <!-- Win Type Badge -->
                    <div id="win-type-badge" class="mb-3"></div>
                    
                    <!-- Message -->
                    <p id="result-message" class="text-white-50 fs-5 mb-4" style="white-space: pre-line;"></p>
                    
                    <!-- Points Card (for chop wins) -->
                    <div id="points-card" class="card bg-white bg-opacity-25 border-0 mb-4" style="display: none;">
                        <div class="card-body py-3">
                            <div class="row text-white">
                                <div class="col-6 border-end border-white border-opacity-25">
                                    <div class="text-white-50 small mb-1">Your Points</div>
                                    <div id="player-points" class="fs-3 fw-bold"></div>
                                </div>
                                <div class="col-6">
                                    <div class="text-white-50 small mb-1">Opponent</div>
                                    <div id="opponent-points" class="fs-3 fw-bold"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Prize Card -->
                    <div id="result-prize" class="card border-0 mb-4">
                        <div class="card-body py-3">
                            <div class="small text-muted mb-1">Prize Money</div>
                            <div id="prize-amount" class="fs-1 fw-bold"></div>
                        </div>
                    </div>
                    
                    <!-- Action Button -->
                    <a href="/" class="btn btn-light btn-lg px-5 fw-bold">Play Again</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Suit Selector Modal (for Aces) -->
    <div class="suit-selector" id="suit-selector">
        <h5 class="text-center mb-4">Choose a Suit (Ace is Wild)</h5>
        <div class="row">
            <div class="col-6">
                <div class="suit-option" onclick="selectSuit('hearts')">
                    ♥<br><small>Hearts</small>
                </div>
            </div>
            <div class="col-6">
                <div class="suit-option" onclick="selectSuit('diamonds')">
                    ♦<br><small>Diamonds</small>
                </div>
            </div>
            <div class="col-6">
                <div class="suit-option" onclick="selectSuit('clubs')">
                    ♣<br><small>Clubs</small>
                </div>
            </div>
            <div class="col-6">
                <div class="suit-option" onclick="selectSuit('spades')">
                    ♠<br><small>Spades</small>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Game Logic - All rendering and game state managed here -->
    <script src="/js/game.js"></script>
</body>
</html>
